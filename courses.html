<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Find the right First Aid course for you. Answer a few quick questions and get a personalised recommendation. CPR, First Aid, Childcare & Advanced courses. RTO #32221.">
    <title>Find Your Course | Coral Sea Training | RTO #32221</title>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&family=DM+Serif+Display&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/style.css">
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Ccircle cx='50' cy='50' r='46' fill='%231B8A3D' stroke='%23D90A0A' stroke-width='6'/%3E%3Ctext x='50' y='68' text-anchor='middle' fill='white' font-size='50' font-weight='bold'%3E+%3C/text%3E%3C/svg%3E">
</head>
<body>
    <!-- Header -->
    <header class="header" id="header">
        <div class="container">
            <div class="header-inner">
                <a href="index.html" class="logo">
                    <div class="logo-mark">+</div>
                    <div class="logo-text">
                        <span class="logo-name">Coral Sea Training</span>
                        <span class="logo-tagline">RTO #32221</span>
                    </div>
                </a>
                <nav class="nav">
                    <a href="index.html" class="nav-link">Home</a>
                    <a href="about.html" class="nav-link">About</a>
                    <a href="courses.html" class="nav-link active">Courses</a>
                    <a href="shop.html" class="nav-link">Shop</a>
                    <a href="contact.html" class="nav-link">Contact</a>
                </nav>
                <div class="header-actions">
                    <a href="tel:0419675022" class="header-phone">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72c.127.96.361 1.903.7 2.81a2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45c.907.339 1.85.573 2.81.7A2 2 0 0 1 22 16.92z"/></svg>
                        0419 675 022
                    </a>
                    <a href="contact.html" class="btn btn-primary">Contact Us</a>
                    <button class="mobile-toggle" id="mobileToggle" aria-label="Menu">
                        <span></span><span></span><span></span>
                    </button>
                </div>
            </div>
        </div>
    </header>

    <div class="mobile-menu" id="mobileMenu">
        <a href="index.html" class="nav-link">Home</a>
        <a href="about.html" class="nav-link">About</a>
        <a href="courses.html" class="nav-link active">Courses</a>
        <a href="shop.html" class="nav-link">Shop</a>
        <a href="contact.html" class="nav-link">Contact</a>
    </div>

    <!-- Funnel Section -->
    <section class="funnel-section">
        <div class="container">
            <div class="funnel-wrapper">

                <!-- Progress Bar -->
                <div class="funnel-progress-wrapper">
                    <div class="funnel-progress-bar">
                        <div class="funnel-progress-fill" id="progressFill" style="width: 20%"></div>
                    </div>
                    <span class="funnel-step-label" id="stepLabel">Step 1 of 5</span>
                </div>

                <!-- Social Proof Banner -->
                <div class="funnel-social-proof">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="width:16px;height:16px;color:var(--green);"><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M23 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></svg>
                    <span>Join <strong>10,000+</strong> Queenslanders who trained with us</span>
                </div>

                <!-- ===== STEP 1: Situation ===== -->
                <div class="funnel-step active" id="step1">
                    <div class="funnel-step-header">
                        <h1 class="funnel-title">Let's Find Your Perfect Course</h1>
                        <p class="funnel-subtitle">Answer a few quick questions and we'll recommend the right training for your situation.</p>
                    </div>

                    <div class="funnel-options funnel-options-4">
                        <button class="funnel-option" onclick="selectOption(1, 'situation', 'workplace', this)">
                            <div class="funnel-option-icon">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="2" y="7" width="20" height="14" rx="2" ry="2"/><path d="M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16"/></svg>
                            </div>
                            <div class="funnel-option-text">
                                <h3>Workplace Compliance</h3>
                                <p>My employer requires first aid certification</p>
                            </div>
                            <div class="funnel-option-check">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="20 6 9 17 4 12"/></svg>
                            </div>
                        </button>

                        <button class="funnel-option" onclick="selectOption(1, 'situation', 'childcare', this)">
                            <div class="funnel-option-icon">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M9 12l2 2 4-4"/><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2z"/></svg>
                            </div>
                            <div class="funnel-option-text">
                                <h3>Childcare / Education</h3>
                                <p>I need ACECQA-approved training for my role</p>
                            </div>
                            <div class="funnel-option-check">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="20 6 9 17 4 12"/></svg>
                            </div>
                        </button>

                        <button class="funnel-option" onclick="selectOption(1, 'situation', 'personal', this)">
                            <div class="funnel-option-icon">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"/></svg>
                            </div>
                            <div class="funnel-option-text">
                                <h3>Personal / Family Safety</h3>
                                <p>I want the confidence to help in an emergency</p>
                            </div>
                            <div class="funnel-option-check">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="20 6 9 17 4 12"/></svg>
                            </div>
                        </button>

                        <button class="funnel-option" onclick="selectOption(1, 'situation', 'team', this)">
                            <div class="funnel-option-icon">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M23 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></svg>
                            </div>
                            <div class="funnel-option-text">
                                <h3>Training For My Team</h3>
                                <p>I need to get multiple staff members certified</p>
                            </div>
                            <div class="funnel-option-check">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="20 6 9 17 4 12"/></svg>
                            </div>
                        </button>
                    </div>
                </div>

                <!-- ===== STEP 2: Group Size ===== -->
                <div class="funnel-step" id="step2">
                    <div class="funnel-step-header">
                        <h2 class="funnel-title">How Many People Need Training?</h2>
                        <p class="funnel-subtitle">This helps us recommend the best option and any available group savings.</p>
                    </div>

                    <div class="funnel-options funnel-options-4">
                        <button class="funnel-option" onclick="selectOption(2, 'groupSize', '1', this)">
                            <div class="funnel-option-icon">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></svg>
                            </div>
                            <div class="funnel-option-text">
                                <h3>Just Me</h3>
                                <p>Individual enrolment</p>
                            </div>
                            <div class="funnel-option-check">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="20 6 9 17 4 12"/></svg>
                            </div>
                        </button>

                        <button class="funnel-option" onclick="selectOption(2, 'groupSize', '2-5', this)">
                            <div class="funnel-option-icon">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M23 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></svg>
                            </div>
                            <div class="funnel-option-text">
                                <h3>Small Group (2&ndash;5)</h3>
                                <p>A few colleagues or friends</p>
                            </div>
                            <div class="funnel-option-check">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="20 6 9 17 4 12"/></svg>
                            </div>
                        </button>

                        <button class="funnel-option" onclick="selectOption(2, 'groupSize', '6-15', this)">
                            <div class="funnel-option-icon">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M23 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></svg>
                            </div>
                            <div class="funnel-option-text">
                                <h3>Medium Group (6&ndash;15)</h3>
                                <p>Department or team training</p>
                            </div>
                            <div class="funnel-option-check">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="20 6 9 17 4 12"/></svg>
                            </div>
                        </button>

                        <button class="funnel-option" onclick="selectOption(2, 'groupSize', '16+', this)">
                            <div class="funnel-option-icon">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M23 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></svg>
                            </div>
                            <div class="funnel-option-text">
                                <h3>Large Group (16+)</h3>
                                <p>Full company or multi-site training</p>
                            </div>
                            <div class="funnel-option-check">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="20 6 9 17 4 12"/></svg>
                            </div>
                        </button>
                    </div>

                    <button class="funnel-back" onclick="goToStep(1)">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="width:16px;height:16px;"><polyline points="15 18 9 12 15 6"/></svg>
                        Back
                    </button>
                </div>

                <!-- ===== STEP 3: Location ===== -->
                <div class="funnel-step" id="step3">
                    <div class="funnel-step-header">
                        <h2 class="funnel-title">Where Would You Prefer to Train?</h2>
                        <p class="funnel-subtitle">We have two venues plus mobile training &mdash; we can come to you.</p>
                    </div>

                    <div class="funnel-options funnel-options-3">
                        <button class="funnel-option" onclick="selectOption(3, 'location', 'townsville', this)">
                            <div class="funnel-option-icon">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"/><circle cx="12" cy="10" r="3"/></svg>
                            </div>
                            <div class="funnel-option-text">
                                <h3>Townsville Venue</h3>
                                <p>40 Charles St, Aitkenvale QLD 4814</p>
                            </div>
                            <div class="funnel-option-check">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="20 6 9 17 4 12"/></svg>
                            </div>
                        </button>

                        <button class="funnel-option" onclick="selectOption(3, 'location', 'widebay', this)">
                            <div class="funnel-option-icon">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"/><circle cx="12" cy="10" r="3"/></svg>
                            </div>
                            <div class="funnel-option-text">
                                <h3>Wide Bay Venue</h3>
                                <p>60 John St, Maryborough QLD 4650</p>
                            </div>
                            <div class="funnel-option-check">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="20 6 9 17 4 12"/></svg>
                            </div>
                        </button>

                        <button class="funnel-option" onclick="selectOption(3, 'location', 'onsite', this)">
                            <div class="funnel-option-icon">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="2" y="7" width="20" height="14" rx="2" ry="2"/><path d="M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16"/></svg>
                            </div>
                            <div class="funnel-option-text">
                                <h3>Come To Our Workplace</h3>
                                <p>Mobile training &mdash; we bring everything to you</p>
                            </div>
                            <div class="funnel-option-check">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="20 6 9 17 4 12"/></svg>
                            </div>
                        </button>
                    </div>

                    <button class="funnel-back" onclick="goToStep(2)">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="width:16px;height:16px;"><polyline points="15 18 9 12 15 6"/></svg>
                        Back
                    </button>
                </div>

                <!-- ===== STEP 4: Urgency ===== -->
                <div class="funnel-step" id="step4">
                    <div class="funnel-step-header">
                        <h2 class="funnel-title">When Do You Need To Be Certified?</h2>
                        <p class="funnel-subtitle">We'll check availability and prioritise urgent bookings.</p>
                    </div>

                    <div class="funnel-options funnel-options-3">
                        <button class="funnel-option" onclick="selectOption(4, 'urgency', 'asap', this)">
                            <div class="funnel-option-icon" style="background: var(--red-light);">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="color: var(--red);"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>
                            </div>
                            <div class="funnel-option-text">
                                <h3>ASAP &mdash; Within a Week</h3>
                                <p>I need this urgently for work or compliance</p>
                            </div>
                            <div class="funnel-option-check">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="20 6 9 17 4 12"/></svg>
                            </div>
                        </button>

                        <button class="funnel-option" onclick="selectOption(4, 'urgency', 'month', this)">
                            <div class="funnel-option-icon">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg>
                            </div>
                            <div class="funnel-option-text">
                                <h3>Within the Next Month</h3>
                                <p>I have some flexibility on dates</p>
                            </div>
                            <div class="funnel-option-check">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="20 6 9 17 4 12"/></svg>
                            </div>
                        </button>

                        <button class="funnel-option" onclick="selectOption(4, 'urgency', 'flexible', this)">
                            <div class="funnel-option-icon">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/></svg>
                            </div>
                            <div class="funnel-option-text">
                                <h3>Flexible / Planning Ahead</h3>
                                <p>No rush &mdash; I'm exploring my options</p>
                            </div>
                            <div class="funnel-option-check">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="20 6 9 17 4 12"/></svg>
                            </div>
                        </button>
                    </div>

                    <button class="funnel-back" onclick="goToStep(3)">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="width:16px;height:16px;"><polyline points="15 18 9 12 15 6"/></svg>
                        Back
                    </button>
                </div>

                <!-- ===== STEP 5: Contact Details ===== -->
                <div class="funnel-step" id="step5">
                    <div class="funnel-step-header">
                        <h2 class="funnel-title">Your Personalised Course Plan is Ready</h2>
                        <p class="funnel-subtitle">Where should we send your course recommendation and booking details? <strong>Having this in your inbox makes it easy to forward to your employer or manager for approval.</strong></p>
                    </div>

                    <div class="funnel-form">
                        <div class="funnel-form-row">
                            <div class="funnel-form-group">
                                <label class="form-label" for="funnelName">Full Name *</label>
                                <input type="text" id="funnelName" class="form-input" placeholder="Your full name" required>
                            </div>
                            <div class="funnel-form-group">
                                <label class="form-label" for="funnelPhone">Phone Number *</label>
                                <input type="tel" id="funnelPhone" class="form-input" placeholder="04XX XXX XXX" required>
                            </div>
                        </div>
                        <div class="funnel-form-group">
                            <label class="form-label" for="funnelEmail">Email Address *</label>
                            <input type="email" id="funnelEmail" class="form-input" placeholder="Your email address" required>
                            <span class="funnel-form-hint">We'll send your course recommendation here &mdash; perfect for forwarding to your boss</span>
                        </div>
                        <div class="funnel-form-group" id="companyField" style="display:none;">
                            <label class="form-label" for="funnelCompany">Company / Organisation</label>
                            <input type="text" id="funnelCompany" class="form-input" placeholder="Your company name">
                        </div>

                        <div class="funnel-form-trust">
                            <div class="funnel-form-trust-item">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="width:16px;height:16px;color:var(--green);"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/><path d="m9 12 2 2 4-4"/></svg>
                                <span>Your details are secure and never shared</span>
                            </div>
                            <div class="funnel-form-trust-item">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="width:16px;height:16px;color:var(--green);"><polyline points="20 6 9 17 4 12"/></svg>
                                <span>No spam &mdash; just your course details</span>
                            </div>
                        </div>

                        <button class="btn btn-primary btn-lg funnel-submit" onclick="submitFunnel()" style="width:100%;">
                            Get My Course Recommendation
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="width:20px;height:20px;"><line x1="5" y1="12" x2="19" y2="12"/><polyline points="12 5 19 12 12 19"/></svg>
                        </button>

                        <p class="funnel-form-disclaimer">By submitting, you agree to be contacted about your course enquiry. We respond within 24 hours.</p>
                    </div>

                    <button class="funnel-back" onclick="goToStep(4)">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="width:16px;height:16px;"><polyline points="15 18 9 12 15 6"/></svg>
                        Back
                    </button>
                </div>

                <!-- ===== STEP 6: Recommendation / Result ===== -->
                <div class="funnel-step" id="step6">
                    <div class="funnel-result" id="funnelResult">
                        <!-- Populated by JavaScript -->
                    </div>
                </div>

            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="footer-grid">
                <div class="footer-brand">
                    <a href="index.html" class="logo">
                        <div class="logo-mark">+</div>
                        <div class="logo-text">
                            <span class="logo-name">Coral Sea Training</span>
                            <span class="logo-tagline">RTO #32221</span>
                        </div>
                    </a>
                    <p>Quality Training Generates Peace of Mind. Nationally accredited First Aid training in Queensland.</p>
                </div>
                <div class="footer-nav">
                    <h4>Quick Links</h4>
                    <ul>
                        <li><a href="index.html">Home</a></li>
                        <li><a href="about.html">About Us</a></li>
                        <li><a href="courses.html">Our Courses</a></li>
                        <li><a href="shop.html">Shop</a></li>
                        <li><a href="contact.html">Contact</a></li>
                    </ul>
                </div>
                <div class="footer-nav">
                    <h4>Courses</h4>
                    <ul>
                        <li><a href="courses.html">CPR (HLTAID009)</a></li>
                        <li><a href="courses.html">First Aid (HLTAID011)</a></li>
                        <li><a href="courses.html">Childcare (HLTAID012)</a></li>
                        <li><a href="courses.html">Advanced (HLTAID015)</a></li>
                    </ul>
                </div>
                <div class="footer-contact">
                    <h4>Contact</h4>
                    <p><strong>Townsville:</strong> <a href="tel:0419675022">0419 675 022</a></p>
                    <p><strong>Wide Bay:</strong> <a href="tel:0488488467">0488 488 467</a></p>
                    <p><a href="mailto:admin@coralseatraining.com.au">admin@coralseatraining.com.au</a></p>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2024 Coral Sea Training. All rights reserved. RTO #32221</p>
                <p><a href="admin/">Admin</a></p>
            </div>
        </div>
    </footer>

    <script src="js/main.js"></script>
    <script>
    // =====================================================
    // Lead Qualification Funnel
    // =====================================================

    var funnelData = {
        situation: '',
        groupSize: '',
        location: '',
        urgency: '',
        name: '',
        email: '',
        phone: '',
        company: ''
    };

    var currentStep = 1;
    var totalSteps = 5;

    function selectOption(step, key, value, btn) {
        funnelData[key] = value;

        // Highlight selected option
        var stepEl = document.getElementById('step' + step);
        stepEl.querySelectorAll('.funnel-option').forEach(function(o) {
            o.classList.remove('selected');
        });
        btn.classList.add('selected');

        // If step 1 is "team", auto-set that they likely want group
        // If step 2 groupSize > 1, show company field later
        if (key === 'groupSize' && value !== '1') {
            document.getElementById('companyField').style.display = 'block';
        } else if (key === 'groupSize' && value === '1') {
            document.getElementById('companyField').style.display = 'none';
        }

        // Auto-advance after short delay for visual feedback
        setTimeout(function() {
            goToStep(step + 1);
        }, 300);
    }

    function goToStep(step) {
        if (step < 1 || step > 6) return;
        currentStep = step;

        // Hide all steps
        document.querySelectorAll('.funnel-step').forEach(function(s) {
            s.classList.remove('active');
        });

        // Show target step
        var target = document.getElementById('step' + step);
        if (target) {
            target.classList.add('active');
        }

        // Update progress
        var progress = step <= totalSteps ? (step / totalSteps * 100) : 100;
        document.getElementById('progressFill').style.width = progress + '%';

        if (step <= totalSteps) {
            document.getElementById('stepLabel').textContent = 'Step ' + step + ' of ' + totalSteps;
        } else {
            document.getElementById('stepLabel').textContent = 'Your recommendation';
        }

        // Scroll to top of funnel
        var funnel = document.querySelector('.funnel-wrapper');
        if (funnel) {
            funnel.scrollIntoView({ behavior: 'smooth', block: 'start' });
        }
    }

    function submitFunnel() {
        // Validate
        var name = document.getElementById('funnelName').value.trim();
        var email = document.getElementById('funnelEmail').value.trim();
        var phone = document.getElementById('funnelPhone').value.trim();
        var company = document.getElementById('funnelCompany').value.trim();

        if (!name) {
            document.getElementById('funnelName').focus();
            shakeField('funnelName');
            return;
        }
        if (!email || email.indexOf('@') === -1) {
            document.getElementById('funnelEmail').focus();
            shakeField('funnelEmail');
            return;
        }
        if (!phone) {
            document.getElementById('funnelPhone').focus();
            shakeField('funnelPhone');
            return;
        }

        funnelData.name = name;
        funnelData.email = email;
        funnelData.phone = phone;
        funnelData.company = company;

        // Generate recommendation
        var rec = getRecommendation();

        // Build result HTML
        var resultHTML = buildResultHTML(rec);
        document.getElementById('funnelResult').innerHTML = resultHTML;

        // Send lead data via mailto (construct email to business)
        sendLeadEmail(rec);

        // Go to result step
        goToStep(6);
    }

    function shakeField(id) {
        var el = document.getElementById(id);
        el.style.borderColor = 'var(--red)';
        el.classList.add('shake');
        setTimeout(function() {
            el.classList.remove('shake');
        }, 500);
    }

    function getRecommendation() {
        var sit = funnelData.situation;
        var group = funnelData.groupSize;
        var loc = funnelData.location;
        var urg = funnelData.urgency;
        var isGroup = group !== '1';

        var rec = {};

        // Determine course based on situation
        if (sit === 'childcare') {
            rec.course = 'Childcare First Aid';
            rec.code = 'HLTAID012';
            rec.badge = 'Recommended For You';
            rec.description = 'The complete childcare first aid package. This ACECQA-approved course covers CPR, First Aid, Anaphylaxis, and Asthma management &mdash; everything required for Cert III, Diploma, and educator roles.';
            rec.duration = 'Approx. 8 hours (1 day)';
            rec.validity = '3 years (CPR component renewed annually)';
            rec.includes = [
                'CPR & AED (HLTAID009)',
                'Provide First Aid (HLTAID011)',
                'Anaphylaxis management',
                'Asthma emergency response',
                'ACECQA approved for childcare',
                'Statement of Attainment on completion'
            ];
        } else if (sit === 'personal') {
            // Upsell from CPR to First Aid
            rec.course = 'Provide First Aid';
            rec.code = 'HLTAID011';
            rec.badge = 'Best For You';
            rec.description = 'Based on your answers, we recommend the full Provide First Aid course. It includes CPR and gives you comprehensive skills to handle real emergencies &mdash; not just resuscitation. You\'ll walk out confident you can genuinely help.';
            rec.duration = 'Approx. 7 hours (1 day)';
            rec.validity = '3 years (CPR component renewed annually)';
            rec.includes = [
                'CPR & AED (HLTAID009) included',
                'Wound management & bandaging',
                'Burns, bites & stings',
                'Fractures & dislocations',
                'Medical emergencies',
                'Statement of Attainment on completion'
            ];
        } else if (sit === 'team') {
            rec.course = 'On-Site Group Training';
            rec.code = 'Custom Package';
            rec.badge = 'Corporate Solution';
            rec.description = 'We\'ll bring nationally accredited training directly to your workplace. Your dedicated training coordinator will design a package around your team\'s needs, schedule, and compliance requirements.';
            rec.duration = 'Flexible &mdash; tailored to your team';
            rec.validity = 'All certifications nationally recognised';
            rec.includes = [
                'All equipment provided &mdash; we set up everything',
                'Choice of CPR, First Aid, or Childcare courses',
                'Volume discounts for 8+ participants',
                'Flexible scheduling around your operations',
                'Compliance reporting for your records',
                'Dedicated training coordinator'
            ];
        } else {
            // workplace - recommend First Aid (HLTAID011)
            rec.course = 'Provide First Aid';
            rec.code = 'HLTAID011';
            rec.badge = 'Most Popular';
            rec.description = 'The go-to course for workplace compliance. Includes CPR certification bundled in, plus full first aid skills your employer requires. Nationally recognised and accepted everywhere in Australia.';
            rec.duration = 'Approx. 7 hours (1 day)';
            rec.validity = '3 years (CPR component renewed annually)';
            rec.includes = [
                'CPR & AED (HLTAID009) included',
                'Basic Emergency Life Support',
                'Workplace first aid skills',
                'Meets WHS compliance requirements',
                'Certificate valid for 3 years',
                'Statement of Attainment on completion'
            ];
        }

        // Add group-specific messaging
        if (isGroup && sit !== 'team') {
            rec.groupNote = true;
            rec.groupMessage = 'Since you\'re booking for ' + group + ' people, you may qualify for group rates. A member of our team will include group pricing in your personalised quote.';
        }

        // Location display
        if (loc === 'townsville') {
            rec.locationDisplay = 'Townsville &mdash; 40 Charles St, Aitkenvale';
        } else if (loc === 'widebay') {
            rec.locationDisplay = 'Wide Bay &mdash; 60 John St, Maryborough';
        } else {
            rec.locationDisplay = 'On-site at your workplace';
        }

        // Urgency messaging
        if (urg === 'asap') {
            rec.urgencyMessage = 'We\'ve flagged your booking as urgent. Our team will prioritise finding you the next available spot.';
        } else if (urg === 'month') {
            rec.urgencyMessage = 'We have multiple course dates available in the coming weeks. We\'ll send you the best options.';
        } else {
            rec.urgencyMessage = 'No rush &mdash; we\'ll send you upcoming course dates so you can choose the one that works best.';
        }

        return rec;
    }

    function buildResultHTML(rec) {
        var checkSvg = '<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="width:18px;height:18px;color:var(--green);flex-shrink:0;"><polyline points="20 6 9 17 4 12"/></svg>';

        var includesHTML = '';
        for (var i = 0; i < rec.includes.length; i++) {
            includesHTML += '<div class="funnel-result-feature">' + checkSvg + '<span>' + rec.includes[i] + '</span></div>';
        }

        var groupHTML = '';
        if (rec.groupNote) {
            groupHTML = '<div class="funnel-result-group-note">' +
                '<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="width:20px;height:20px;color:#f59e0b;flex-shrink:0;"><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M23 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></svg>' +
                '<p>' + rec.groupMessage + '</p>' +
                '</div>';
        }

        var html = '' +
            '<div class="funnel-result-success">' +
                '<div class="funnel-result-check">' +
                    '<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/><polyline points="22 4 12 14.01 9 11.01"/></svg>' +
                '</div>' +
                '<h2>Great News, ' + funnelData.name.split(' ')[0] + '!</h2>' +
                '<p>Based on your answers, here\'s what we recommend for you:</p>' +
            '</div>' +

            '<div class="funnel-result-card">' +
                '<div class="funnel-result-badge">' + rec.badge + '</div>' +
                '<h3 class="funnel-result-course">' + rec.course + '</h3>' +
                '<p class="funnel-result-code">' + rec.code + '</p>' +
                '<p class="funnel-result-desc">' + rec.description + '</p>' +

                '<div class="funnel-result-meta">' +
                    '<div class="funnel-result-meta-item">' +
                        '<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="width:18px;height:18px;color:var(--red);"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>' +
                        '<div><strong>Duration:</strong> ' + rec.duration + '</div>' +
                    '</div>' +
                    '<div class="funnel-result-meta-item">' +
                        '<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="width:18px;height:18px;color:var(--red);"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/></svg>' +
                        '<div><strong>Validity:</strong> ' + rec.validity + '</div>' +
                    '</div>' +
                    '<div class="funnel-result-meta-item">' +
                        '<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="width:18px;height:18px;color:var(--red);"><path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"/><circle cx="12" cy="10" r="3"/></svg>' +
                        '<div><strong>Location:</strong> ' + rec.locationDisplay + '</div>' +
                    '</div>' +
                '</div>' +

                '<div class="funnel-result-features">' +
                    '<h4>What\'s Included:</h4>' +
                    includesHTML +
                '</div>' +

                groupHTML +

                '<div class="funnel-result-urgency">' +
                    '<p>' + rec.urgencyMessage + '</p>' +
                '</div>' +
            '</div>' +

            '<div class="funnel-result-actions">' +
                '<div class="funnel-result-confirmation">' +
                    '<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="width:20px;height:20px;color:var(--green);"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/><polyline points="22 4 12 14.01 9 11.01"/></svg>' +
                    '<p><strong>Your details have been sent to our team.</strong> We\'ll be in touch within 24 hours with your personalised booking details and next available course dates.</p>' +
                '</div>' +

                '<div class="funnel-result-next-steps">' +
                    '<h4>What Happens Next?</h4>' +
                    '<div class="funnel-result-step"><span class="funnel-result-step-num">1</span><p>Our team reviews your details and checks availability</p></div>' +
                    '<div class="funnel-result-step"><span class="funnel-result-step-num">2</span><p>We\'ll email you course dates, pricing, and booking confirmation</p></div>' +
                    '<div class="funnel-result-step"><span class="funnel-result-step-num">3</span><p>Forward the email to your employer for approval if needed</p></div>' +
                '</div>' +

                '<div class="funnel-result-cta-row">' +
                    '<a href="tel:0419675022" class="btn btn-primary btn-lg">' +
                        '<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="width:20px;height:20px;"><path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72c.127.96.361 1.903.7 2.81a2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45c.907.339 1.85.573 2.81.7A2 2 0 0 1 22 16.92z"/></svg>' +
                        'Want to Book Now? Call Us' +
                    '</a>' +
                    '<a href="index.html" class="btn btn-outline btn-lg">Back to Homepage</a>' +
                '</div>' +
            '</div>';

        return html;
    }

    function sendLeadEmail(rec) {
        // Build email body with all lead data
        var subject = encodeURIComponent('Course Enquiry: ' + rec.course + ' - ' + funnelData.name);
        var body = encodeURIComponent(
            'NEW LEAD FROM WEBSITE FUNNEL\n' +
            '================================\n\n' +
            'Name: ' + funnelData.name + '\n' +
            'Email: ' + funnelData.email + '\n' +
            'Phone: ' + funnelData.phone + '\n' +
            (funnelData.company ? 'Company: ' + funnelData.company + '\n' : '') +
            '\n' +
            'PREFERENCES\n' +
            '--------------------------------\n' +
            'Situation: ' + funnelData.situation + '\n' +
            'Group Size: ' + funnelData.groupSize + '\n' +
            'Preferred Location: ' + funnelData.location + '\n' +
            'Urgency: ' + funnelData.urgency + '\n' +
            '\n' +
            'RECOMMENDATION\n' +
            '--------------------------------\n' +
            'Course: ' + rec.course + ' (' + rec.code + ')\n' +
            '\n' +
            'This lead was generated from the course finder funnel on the website.'
        );

        // Open mailto in background (creates the email)
        var mailtoLink = 'mailto:admin@coralseatraining.com.au?subject=' + subject + '&body=' + body;

        // Create a hidden iframe to trigger mailto without navigating away
        var iframe = document.createElement('iframe');
        iframe.style.display = 'none';
        iframe.src = mailtoLink;
        document.body.appendChild(iframe);
        setTimeout(function() {
            document.body.removeChild(iframe);
        }, 2000);

        // Also log for analytics
        console.log('Lead submitted:', funnelData);
        if (typeof gtag !== 'undefined') {
            gtag('event', 'funnel_lead', {
                'event_category': 'Lead Generation',
                'event_label': rec.course,
                'value': funnelData.groupSize === '16+' ? 3 : (funnelData.groupSize === '6-15' ? 2 : 1)
            });
        }
    }
    </script>
</body>
</html>
